#!/usr/bin/env python
import xmlrpc
import os
import sys

def main():
    try:
        host=os.environ['MCFOOHOST']
    except KeyError:
        host='localhost'
            
    try:
        port=int(os.environ['MCFOOPORT'])
    except KeyError:
        port=25706
                
    c = xmlrpc.client(host, port)

    pri=sys.argv[1]
    pri=int(pri)
    backend=sys.argv[2]
    media=sys.argv[3]
    
    sys.path.append('/usr/lib/mc-foo/lib/python')
    import McFoo.song
    media=McFoo.song.makesafe(media)
    
    file=sys.argv[4]
    s=c.execute('mcfoo.addqueue', [(pri, backend, media, file)])
    
if __name__ == "__main__":
    main()
